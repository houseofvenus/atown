<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <link rel="apple-touch-icon" sizes="180x180" href="../media/icon/apple-touch-icon.png">
    <link rel="icon" type="image/png" href="../media/icon/favicon.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Braah+One&display=swap" rel="stylesheet">
    <title>v. 0.9.4.c</title>
    <link rel ="stylesheet" type="text/css" href="../css/PublicAugmentedRealityKinectome.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
   integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
   crossorigin=""/>
    <link rel="stylesheet" type="text/css" href="../css/library-map-filter.css" />
</head>
<body>
    <div id="success-container">
        <div id="success-icon-container"></div>
        <div id="success-text-container">Your Request Is Being Completed</div>
    </div>
    <div id="check-out-book-container" class="park-module-container">
        <h2 id="schedule-instructions-title-container">Check Out</h2>
        <p class="park-module-instruction-paragraph-container">Select a start point for your delivery by clicking on a location on the map</p>
        <p class="park-module-instruction-paragraph-container">Select a destination point for your delivery by clicking on a location on the map</p>
        <p class="park-module-instruction-paragraph-container">To customize flight settings, click on the generated flight path</p>
        <p class="park-module-instruction-paragraph-container">Note: only one flight can be scheduled at a time</p>
        <p class="park-module-instruction-paragraph-container">When you are ready to begin click start below!</p>
        <input type="button" value="deliver" id="start-scheduling-delivery-button-container" class="start-scheduling-button-container"/>
    </div>
    <div id="return-book-container" class="library-action-module-container">
        <h2 id="return-book-header-container">Book Return</h2>
        <p class="return-book-text-container">You selected the following title for book return:</p>
        <div id="return-book-cover-container"></div>
        <h3 id="return-book-title-container"></h3>
        <p id="return-book-owner-container"></p>
        <input type="button" value="Return This Book" id="start-book-return-button-container"/>
    </div>
    
    <div id="main-app-container">
        <!--<input id="register-for-pARk-button-container" value="" type="button">-->
        <div id="user-access-layer-container" class="page-container layer-container upper-layer-container">
            <div id="instructions-wrapper-container">
                <p id="welcome-instruction-header-container">
                    The Little Free Digital Library
                </p>
                <div class="instructions-block">
                    <p>
                        Welcome to the Little Free Digital Library System! Explore Little Free Library collections near you, online.
                    </p>
                    <div id="instruction-graphic-1-container" class="instruction-graphic-container"></div>
                    <p>
                        Click on the icons to browse, borrow, share, and/or return books online. Some collections also contain digital media (films, ebook, etc).
                    </p>
                  <!--  <p>
                        All orders will be delivered to the nearest Door. To use Direct Delivery access the pARk through your cARd.-->
                        <!-- Tap items to view and order.
                    </p>-->
                </div>
                <!--<p id="tap-to-start-title-container">
                    tap anywhere to start
                </p>-->
            </div>
        </div>
        <div id="create-account-input-container" class="create-input-container">
            <div id="capture-options-container">
                <input id="dps2-call-button-container" class="create-input-option-button-container" value="" type="button">
                <input type="button" class="create-input-option-button-container" id="film-capture-button-container" value=""/>
                <input type="button" class="create-input-option-button-container" id="delivery-capture-button-container" value=""/>
                <input type="button" class="create-input-option-button-container" id="d2-capture-button-container" value=""/>
            </div>
        </div>
        
        
        
        <div id="create-account-button-container" class="create-button-container"></div>
        <div id="map" class="layer-container base-layer-container">
        </div>
    </div>
    <!-- https://unpkg.com/leaflet@1.9.4/dist/leaflet.js
integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
   crossorigin=""-->
    <script src="./js/park.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.2/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.2/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.2/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.2/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.2/firebase-storage.js"></script>
    <script>
        var storage, database;

        const config = {
          apiKey: "AIzaSyAzqXRxpmI9K7UMTsiuFU6b54SkSjNojkU",
          authDomain: "lyoko-blockchain.firebaseapp.com",
          databaseURL: "https://lyoko-blockchain-default-rtdb.europe-west1.firebasedatabase.app",
          projectId: "lyoko-blockchain",
          storageBucket: "lyoko-blockchain.appspot.com",
          messagingSenderId: "820284895954",
          appId: "1:820284895954:web:e69039cadfd002bc15b30b"
        };
        
        function initMap() {
            
            document.getElementById("start-book-return-button-container").addEventListener("click", function(){
                document.getElementById("return-book-container").style.display = "none";
                document.getElementById("success-container").style.display = "block";
                setTimeout(function(){
                    document.getElementById("success-container").style.display = "none";
                }, 5000);
            });
           
            map = L.map('map').setView([38.929990, -77.036990], 16);
            
            var LittleFreeDigitalLibraryIconMap = [
                {
                    name: "Harvard St Library",
                    icon: L.icon({
                        iconUrl: './media/img/library-icon.png',
                        iconSize: [100, 80],
                        popupAnchor: [38.929135, -77.035661]
                    }),
                },
                {
                    name: "Patrice-Morgan's Library",
                    icon: L.icon({
                        iconUrl: './media/img/library-icon.png',
                        iconSize: [100, 80],
                        popupAnchor: [38.932696, -77.039743]
                    })
                },
                {
                    name: "KT's Library",
                    icon: L.icon({
                        iconUrl: './media/img/library-icon.png',
                        iconSize: [100, 80],
                        popupAnchor: [38.933563, -77.038869]
                    }),
                }
            ];
            
            var LittleFreeDigitalLibrary = [
                {
                    name: "Harvard St Library",
                    marker: L.marker([38.926350, -77.036692], {icon: LittleFreeDigitalLibraryIconMap[0].icon}),
                    popup: L.popup([38.926350, -77.036692], {
                        content: `<h3 id="harvard-st-library-header-container" class="header-container">Harvard St Library</h3><div class="header-icon-container" id="harvard-st-library-header-icon-container"></div><div class="library-catalog-container">
                        <button id="table-tennis-balls-option-container" class="option-button-container"></button>
                        <button id="natty-boh-1-option-container" class="option-button-container"></button>
                        <button id="pbr-1-option-container" class="option-button-container"></button></div>`
                    })
                },
                {
                    name: "Patrice-Morgan's Library",
                    marker: L.marker([38.932696, -77.039743], {icon: LittleFreeDigitalLibraryIconMap[1].icon}),
                    popup: L.popup([38.932696, -77.039743], {
                        content: `<h3 id="pm-library-header-container" class="header-container">Patrice-Morgan's Library</h3><div id="pm-library-header-icon-container" class="header-icon-container"></div><div id="pm-library-catalog-container">
                        <button id="because-of-sex-book-option-container" class="book-option-button-container"></button>
                        <button id="the-house-of-scorpion-book-option-container" class="book-option-button-container"></button>
                        <button id="the-nazi-seizure-of-power-book-option-container" class="book-option-button-container"></button>
                        <button id="the-book-of-forgiving-book-option-container" class="book-option-button-container"></button>
                        <button id="l4yer-cake-book-option-container" class="book-option-button-container"></button>
                        </div>`
                    })/*<button id="from-farmland-to-streetlevel-book-0-option-container" class="book-option-button-container"></button>*/
                },
                {
                    name: "KT's Library",
                    marker: L.marker([38.933563, -77.038869], {icon: LittleFreeDigitalLibraryIconMap[2].icon}),
                    popup: L.popup([38.933563, -77.038869], {
                        content: `<h3 id="kt-library-header-container" class="header-container">KT's Library</h3><div id="kt-library-header-icon-container" class="header-icon-container"></div><div id="pm-library-catalog-container">
                        <button id="from-farmland-to-streetlevel-book-1-option-container" class="book-option-button-container"></button>
                        <button id="dragons-heart-book-option-container" class="book-option-button-container"></button>
                        <button id="father-of-the-bride-book-option-container" class="book-option-button-container"></button>
                        <button id="key-west-connection-book-option-container" class="book-option-button-container"></button>
                        <button id="critique-of-pure-reason-book-option-container" class="book-option-button-container"></button>
                        <button id="time-and-the-other-book-option-container" class="book-option-button-container"></button>
                        <button id="stop-dressing-your-six-year-old-like-a-skank-book-option-container" class="book-option-button-container"></button>
                        <button id="the-theatre-of-the-absurd-book-option-container" class="book-option-button-container"></button>
                        <button id="on-the-plurality-of-worlds-book-option-container" class="book-option-button-container"></button>
                        <button id="a-history-of-the-modern-middle-east-book-option-container" class="book-option-button-container"></button>
                        <button id="total-immersion-book-option-container" class="book-option-button-container"></button>

<button id="the-theatre-of-the-absurd-book-option-container" class="book-option-button-container"></button>
<button id="stealth-of-nations-book-option-container" class="book-option-button-container"></button>
<button id="extreme-ownership-book-option-container" class="book-option-button-container"></button>
<button id="the-house-on-mango-street-book-option-container" class="book-option-button-container"></button>
<button id="guardians-of-gahoole-capture-book-option-container" class="book-option-button-container"></button>
<button id="dynamics-of-faith-book-option-container" class="book-option-button-container"></button>
<button id="miss-emily-book-option-container" class="book-option-button-container"></button>
<button id="desert-queen-book-option-container" class="book-option-button-container"></button>
<button id="a-woman-in-arabia-book-option-container" class="book-option-button-container"></button>
<button id="the-black-country-book-option-container" class="book-option-button-container"></button>
<button id="the-logical-basis-of-metaphysics-book-option-container" class="book-option-button-container"></button>
<button id="the-devils-workshop-book-option-container" class="book-option-button-container"></button>
<button id="mauds-line-book-option-container" class="book-option-button-container"></button>
                        </div>`
                    })
                }
            ]
            
           L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© House of Venus'
            }).addTo(map);

            map.on('click', onMapClick);
            
            
            LittleFreeDigitalLibrary[0].marker.bindPopup(LittleFreeDigitalLibrary[0].popup);
            
            LittleFreeDigitalLibrary[0].marker.on("popupopen", function(){
                document.getElementById("member-options-container").innerHTML = "<h3>Harvard St Library</h3><p class='popup-description-container'>Party On New Generation . New Season Begins Labor Day Weekend!</p><p>üëª üî™ Hours</p><h5>12:00AM to 6:00AM</h5>";
                
                
                maidenPop[4] = true;

                document.getElementById("natty-boh-1-option-container").addEventListener("click", function(){
                    document.getElementById("member-options-container").innerHTML = "<h3>Natty Boh</h3><p class='popup-description-container'></p><p>1 count</p><p  class='popup-description-container'></p><button class='add-item-to-order-queue-button-container'>Order Now</button>";
                });

                document.getElementById("pbr-1-option-container").addEventListener("click", function(){
                    document.getElementById("member-options-container").innerHTML = "<h3>PBR</h3><p class='popup-description-container'></p><p>1 count</p><p  class='popup-description-container'></p><button class='add-item-to-order-queue-button-container'>Order Now</button>";
                });
                
            });
            
            LittleFreeDigitalLibrary[0].marker.on("popupclose", function(){
                document.getElementById("member-options-container").innerHTML = "<h3>The Little Free Digital Library</h3><p>Hello World! Click on an icon to start.</p><br/><h3>Key</h3><p>üìö Library</p><p>üßëüèΩ‚Äçüè´ , üöÅLibrarian</p>"
            });
            
            
            LittleFreeDigitalLibrary[1].marker.bindPopup(LittleFreeDigitalLibrary[1].popup);
            
            LittleFreeDigitalLibrary[1].marker.on("popupopen", function(){
                document.getElementById("member-options-container").innerHTML = "<h3>Patrice-Morgan's Library</h3><p class='popup-description-container'>Welcome to my Digital Little Free Library! Feel free to explore, share, and borrow from my collection.</p><p>üöÅ Hours</p><h5>11:00AM to 11:00PM</h5><p>üìö Hours</p><h5>Open 24/7</h5>";
                
                
                maidenPop[6] = true;

                document.getElementById("because-of-sex-book-option-container").addEventListener("click", function(){
                    document.getElementById("member-options-container").innerHTML = "<h3>Because of Sex</h3><h5>‚è∞ 15 to 30 min</h5><p class='popup-description-container'>Gillian Thomas's Because of Sex tells the story of how one law, our highest court, and a few tenacious women changed the American workplace forever.</p><p>1 count</p><button id='because-of-sex-digital-link-container' class='view-digital-book-button-container'>Digital</button><button id='check-out-because-of-sex-button-container' class='add-item-to-order-queue-button-container'>Check Out</button>";
                    
                    document.getElementById('because-of-sex-digital-link-container').addEventListener("click", function(){
                        window.open("./media/book/Because-Of-Sex.pdf", "_blank");
                    });
                    
                    document.getElementById('check-out-because-of-sex-button-container').addEventListener("click", function(){
                        console.log("Check Out 'Because of Sex'");
                    });
                });
                
                
                document.getElementById("the-house-of-scorpion-book-option-container").addEventListener("click", function(){
                    document.getElementById("member-options-container").innerHTML = "<h3>The House of the Scorpion</h3><h5>‚è∞ 15 to 30 min</h5><p class='popup-description-container'>In a future where humans despise clones, Matt enjoys special status as the young clone of El Patr√≥n, the 140-year-old leader of a corrupt drug empire nestled between Mexico and the United States.</p><p>1 count</p><button id='the-house-of-scorpion-digital-link-container' class='view-digital-book-button-container'>Digital</button><button id='check-out-the-house-of-scorpion-button-container' class='add-item-to-order-queue-button-container'>Check Out</button>";
                    
                    document.getElementById("the-house-of-scorpion-digital-link-container").addEventListener("click", function(){
                        window.open("./media/book/The-House-Of-The-Scorpion.pdf", "_blank");
                    });
                    
                    document.getElementById("check-out-the-house-of-scorpion-button-container").addEventListener("click", function(){
                        console.log("Check Out 'The House of the Scorpion'");
                    });
                });
                
                document.getElementById("the-nazi-seizure-of-power-book-option-container").addEventListener("click", function(){
                    document.getElementById("member-options-container").innerHTML = "<h3>The Nazi Seizure of Power</h3><h5>‚è∞ 15 to 30 min</h5><p class='popup-description-container'>William Sheridan Allen's research provides an intimate, comprehensive study of the mechanics of revolution and an analysis of the Nazi Party's subversion of democracy. Beginning at the end of the Weimar Republic, Allen examines the entire period of the Nazi Revolution within a single locality.</p><p>1 count</p><button id='the-nazi-seizure-of-power-digital-link-container' class='view-digital-book-button-container'>Digital</button><button id='check-out-the-nazi-seizure-of-power-button-container' class='add-item-to-order-queue-button-container'>Check Out</button>";
                    
                    document.getElementById("the-nazi-seizure-of-power-digital-link-container").addEventListener("click", function(){
                         window.open("./media/book/The-Nazi-Seizure-Of-Power.pdf", "_blank");
                    });
                    
                    document.getElementById("check-out-the-nazi-seizure-of-power-button-container").addEventListener("click", function(){
                        console.log("Check Out 'The Nazi Seizure of Power'");
                    });
                });
                
              /*  document.getElementById("from-farmland-to-streetlevel-book-0-option-container").addEventListener("click", function(){
                    document.getElementById("member-options-container").innerHTML = "<h3>From Farmland to Streetlevel</h3><h5>‚è∞ 15 to 30 min</h5><p class='popup-description-container'>A thesis about direct trade coffee in Honduras</p><p>1 count</p><button id='from-farmland-to-streetlevel-digital-link-0-container' class='view-digital-book-button-container'>Digital</button><button id='return-farmland-book-0-button-container' class='return-book-button-container'>Return</button>";
                    
                    document.getElementById("from-farmland-to-streetlevel-digital-link-0-container").addEventListener("click", function(){
                        window.open("https://www.amazon.com/Farmlevel-Streetlevel-Ethnography-Direct-Honduras/dp/1512067105", "_blank");
                    });
                    
                    document.getElementById("return-farmland-book-0-button-container").addEventListener("click", function(){
                        console.log("Return 'From Farmland to StreetLevel'");
                        document.getElementById("return-book-container").style.display = "block";
                        document.getElementById("return-book-cover-container").style.backgroundImage = "url(./media/img/from-farmland-to-streetlevel-book-cover.png)";
                        document.getElementById("return-book-title-container").innerHTML = "From Farmland to Streetlevel";
                        document.getElementById("return-book-owner-container").innerHTML = "Owner: Katie | Borrower: Patrice-Morgan";
                    });
                });
                 hide the above function once demo is done*/
                
                document.getElementById("the-book-of-forgiving-book-option-container").addEventListener("click", function(){
                    document.getElementById("member-options-container").innerHTML = "<h3>The Book of Forgiving</h3><h5>‚è∞ 15 to 30 min</h5><p class='popup-description-container'>The Book of Forgiving is both a touchstone and a tool, offering Tutu's wise advice and showing the way to experience forgiveness.</p><p>1 count</p><button id='the-book-of-forgiving-digital-link-container' class='view-digital-book-button-container'>Digital</button><button id='return-the-book-of-forgiving-button-container' class='return-book-button-container'>Return</button>";
                
                    document.getElementById("the-book-of-forgiving-digital-link-container").addEventListener("click", function(){
                        window.open("./media/book/The-Book-Of-Forgiving.pdf", "_blank");
                    });
                    
                    document.getElementById("return-the-book-of-forgiving-button-container").addEventListener("click", function(){
                        console.log("Return 'The Book of Forgiving'");
                    });
                });
                
                document.getElementById("l4yer-cake-book-option-container").addEventListener("click", function(){
                    document.getElementById("member-options-container").innerHTML = "<h3>L4yer Cake</h3><h5>‚è∞ 15 to 30 min</h5><p class='popup-description-container'>Smooth-talking drug dealer X has a plan to quietly bankroll enough cash to retire before his thirtieth birthday. Operating under the polished veneer of a legitimate businessman, his mantra is to keep a low profile and run a tight operation until it's time to get out.</p><p>1 count</p><button id='l4yer-cake-digital-link-container' class='view-digital-book-button-container'>Digital</button><button id='return-l4yer-cake-button-container' class='return-book-button-container'>Return</button>";
                    
                    document.getElementById("l4yer-cake-digital-link-container").addEventListener("click", function(){
                        window.open("./media/book/L4yer-Cake.pdf", "_blank");
                    });
                    
                    document.getElementById("return-l4yer-cake-button-container").addEventListener("click", function(){
                        console.log("Return 'L4yer Cake'");
                    });

                });
            });
            
            LittleFreeDigitalLibrary[1].marker.on("popupclose", function(){
                document.getElementById("member-options-container").innerHTML = "<h3>The Little Free Digital Library</h3><p>Hello World! Click on an icon to start.</p><br/><h3>Key</h3><p>üìö Library</p><p>üßëüèΩ‚Äçüè´ , üöÅLibrarian</p>"
            });
            
            
             LittleFreeDigitalLibrary[2].marker.bindPopup(LittleFreeDigitalLibrary[2].popup);
            
            LittleFreeDigitalLibrary[2].marker.on("popupopen", function(){
                document.getElementById("member-options-container").innerHTML = "<h3>KT's Library</h3><p class='popup-description-container'>Welcome to my Digital Little Free Library! Feel free to explore, share, and borrow from my collection.</p><p>üöÅ Hours</p><h5>11:00AM to 11:00PM</h5><p>üìö Hours</p><h5>Open 24/7</h5>";
                
                //maidenPop[6] = true;
                
                document.getElementById("from-farmland-to-streetlevel-book-1-option-container").addEventListener("click", function(){
                    document.getElementById("member-options-container").innerHTML = "<h3>From Farmland to Streetlevel</h3><h5>‚è∞ 15 to 30 min</h5><p class='popup-description-container'>A thesis about direct trade coffee in Honduras</p><p>1 count</p><button id='from-farmland-to-streetlevel-digital-link-1-container' class='view-digital-book-button-container'>Digital</button><button id='check-out-from-farmland-to-streetlevel-book-1-button-container' class='add-item-to-order-queue-button-container'>Check Out</button>";
                    
                    document.getElementById("from-farmland-to-streetlevel-digital-link-1-container").addEventListener("click", function(){
                        window.open("https://www.amazon.com/Farmlevel-Streetlevel-Ethnography-Direct-Honduras/dp/1512067105", "_blank");
                    });
                    
                    document.getElementById("check-out-from-farmland-to-streetlevel-book-1-button-container").addEventListener("click", function(){
                        console.log("Check Out 'Farmland to Streetlevel'");
                    });
                });
                
                document.getElementById("dragons-heart-book-option-container").addEventListener("click", function(){
                    document.getElementById("member-options-container").innerHTML = "<h3>Dragon's Heart</h3><h5>‚è∞ 15 to 30 min</h5><p class='popup-description-container'>Austar IV isn't the planet it once was, and when Jakkin and Akki finally return to the dragon nursery, their homecoming arouses mixed emotions...</p><p>1 count</p><button id='dragons-heart-digital-link-container' class='view-digital-book-button-container'>Digital</button><button id='check-out-dragons-heart-book-button-container' class='add-item-to-order-queue-button-container'>Check Out</button>";
                });
                
                document.getElementById("father-of-the-bride-book-option-container").addEventListener("click", function(){
                    document.getElementById("member-options-container").innerHTML = "<h3>Father of the Bride</h3><h5>‚è∞ 15 to 30 min</h5><p class='popup-description-container'>The New York Times bestselling classic tale about modern marriage and the basis for the popular films is now back in print!</p><p class='popup-description-container'>Poor Mr. Banks! His jacket is too tight, he can‚Äôt get a cocktail, and he‚Äôs footing the bill...He‚Äôs the father of the bride.</p><p>1 count</p><button id='father-of-the-bride-digital-link-container' class='view-digital-book-button-container'>Digital</button><button id='check-out-father-of-the-bride-book-button-container' class='add-item-to-order-queue-button-container'>Check Out</button>";
                });
                
                document.getElementById("key-west-connection-book-option-container").addEventListener("click", function(){
                    document.getElementById("member-options-container").innerHTML = "<h3>Key West Connection</h3><h5>‚è∞ 15 to 30 min</h5><p class='popup-description-container'>a violent plunge into the depths of the Gulf Stream as one man‚Äôs vengeance becomes another‚Äôs worst nightmare...</p><p>1 count</p><button id='key-west-connection-digital-link-container' class='view-digital-book-button-container'>Digital</button><button id='check-out-key-west-connection-book-button-container' class='add-item-to-order-queue-button-container'>Check Out</button>";
                });
                
                document.getElementById("critique-of-pure-reason-book-option-container").addEventListener("click", function(){
                    document.getElementById("member-options-container").innerHTML = "<h3>Critique of Pure Reason</h3><h5>‚è∞ 15 to 30 min</h5><p class='popup-description-container'>a violent plunge into the depths of the Gulf Stream as one man‚Äôs vengeance becomes another‚Äôs worst nightmare...</p><p>1 count</p><button id='critique-of-pure-reason-digital-link-container' class='view-digital-book-button-container'>Digital</button><button id='check-out-critique-of-pure-reason-book-button-container' class='add-item-to-order-queue-button-container'>Check Out</button>";
                });
                
                document.getElementById("time-and-the-other-book-option-container").addEventListener("click", function(){
                    document.getElementById("member-options-container").innerHTML = "<h3>Time and the Other</h3><h5>‚è∞ 15 to 30 min</h5><p class='popup-description-container'>a violent plunge into the depths of the Gulf Stream as one man‚Äôs vengeance becomes another‚Äôs worst nightmare...</p><p>1 count</p><button id='time-and-the-other-digital-link-container' class='view-digital-book-button-container'>Digital</button><button id='check-out-time-and-the-other-book-button-container' class='add-item-to-order-queue-button-container'>Check Out</button>";
                });
                
                document.getElementById("stop-dressing-your-six-year-old-like-a-skank-book-option-container").addEventListener("click", function(){
                    document.getElementById("member-options-container").innerHTML = "<h3>Stop Dressing Your Six Year Old Like a Skank</h3><h5>‚è∞ 15 to 30 min</h5><p class='popup-description-container'>a violent plunge into the depths of the Gulf Stream as one man‚Äôs vengeance becomes another‚Äôs worst nightmare...</p><p>1 count</p><button id='stop-dressing-your-six-year-old-like-a-skank-digital-link-container' class='view-digital-book-button-container'>Digital</button><button id='check-out-stop-dressing-your-six-year-old-like-a-skank-book-button-container' class='add-item-to-order-queue-button-container'>Check Out</button>";
                });
                
                document.getElementById("the-theatre-of-the-absurd-book-option-container").addEventListener("click", function(){
                    document.getElementById("member-options-container").innerHTML = "<h3>The Theatre of the Absurd</h3><h5>‚è∞ 15 to 30 min</h5><p class='popup-description-container'>a violent plunge into the depths of the Gulf Stream as one man‚Äôs vengeance becomes another‚Äôs worst nightmare...</p><p>1 count</p><button id='the-theatre-of-the-absurd-digital-link-container' class='view-digital-book-button-container'>Digital</button><button id='check-out-the-theatre-of-the-absurd-book-button-container' class='add-item-to-order-queue-button-container'>Check Out</button>";
                });
                
                document.getElementById("on-the-plurality-of-worlds-book-option-container").addEventListener("click", function(){
                    document.getElementById("member-options-container").innerHTML = "<h3>On the Plurality of Worlds</h3><h5>‚è∞ 15 to 30 min</h5><p class='popup-description-container'>a violent plunge into the depths of the Gulf Stream as one man‚Äôs vengeance becomes another‚Äôs worst nightmare...</p><p>1 count</p><button id='on-the-plurality-of-worlds-digital-link-container' class='view-digital-book-button-container'>Digital</button><button id='check-out-on-the-plurality-of-worlds-book-button-container' class='add-item-to-order-queue-button-container'>Check Out</button>";
                });
                
                document.getElementById("a-history-of-the-modern-middle-east-book-option-container").addEventListener("click", function(){
                    document.getElementById("member-options-container").innerHTML = "<h3>A History of the Modern Middle East</h3><h5>‚è∞ 15 to 30 min</h5><p class='popup-description-container'>a violent plunge into the depths of the Gulf Stream as one man‚Äôs vengeance becomes another‚Äôs worst nightmare...</p><p>1 count</p><button id='a-history-of-the-modern-middle-east-digital-link-container' class='view-digital-book-button-container'>Digital</button><button id='check-out-a-history-of-the-modern-middle-east-book-button-container' class='add-item-to-order-queue-button-container'>Check Out</button>";
                });
                
                document.getElementById("total-immersion-book-option-container").addEventListener("click", function(){
                    document.getElementById("member-options-container").innerHTML = "<h3>Total Immersion: The Revolutionary Way To Swim Better, Faster, and Easier</h3><h5>‚è∞ 15 to 30 min</h5><p class='popup-description-container'>a violent plunge into the depths of the Gulf Stream as one man‚Äôs vengeance becomes another‚Äôs worst nightmare...</p><p>1 count</p><button id='total-immersion-digital-link-container' class='view-digital-book-button-container'>Digital</button><button id='check-out-total-immersion-book-button-container' class='add-item-to-order-queue-button-container'>Check Out</button>";
                });
            });
            
            LittleFreeDigitalLibrary[2].marker.on("popupclose", function(){
                document.getElementById("member-options-container").innerHTML = "<h3>The Little Free Digital Library</h3><p>Hello World! Click on an icon to start.</p><br/><h3>Key</h3><p>üìö Library</p><p>üßëüèΩ‚Äçüè´ , üöÅLibrarian</p>"
            });
            
            
            LittleFreeDigitalLibrary[0].marker.addTo(map);
            LittleFreeDigitalLibrary[1].marker.addTo(map);
            LittleFreeDigitalLibrary[2].marker.addTo(map);
            
            var maidenPop = [
                false,
                false
            ];
            //loadMarkers();
            
           var memberOptionsContainer = document.createElement("div");
            memberOptionsContainer.setAttribute("id", "member-options-container");
            memberOptionsContainer.innerHTML = "<h3>The Little Free Digital Library</h3><p>Hello World! Click on an icon to start.</p><br/><h3>Key</h3><p>üìö Library</p><p>üßëüèΩ‚Äçüè´ , üöÅLibrarian</p>";
            document.getElementById("main-app-container").append(memberOptionsContainer);
            
            document.getElementById("user-access-layer-container").style.display = "none";
            document.getElementById("user-access-layer-container").style.zIndex = "-1";
        }
        
        function onMapClick(e) {
            console.log("Click @ " + e.latlng);
        }

        function downloadDailyDeliveryTargets(deliverNodes){
            let dailyDeliveryTargets = deliverNodes;
            console.log("----------------------\nKnown Daily Delivery Targets");
            var realDeliveryTargets = [];

            var targetTitles = Object.keys(dailyDeliveryTargets);
            for(var currentTitle = 0; currentTitle < targetTitles.length; currentTitle++){
              (function(){
                if(targetTitles[currentTitle].indexOf("order-")>-1){
                  let currentDeliveryTarget = dailyDeliveryTargets[targetTitles[currentTitle]];
                  realDeliveryTargets.push(currentDeliveryTarget);

                  if(currentDeliveryTarget.zoom){
                      iconSize = new google.maps.Size(currentDeliveryTarget.iconSize.x, currentDeliveryTarget.iconSize.y);
                  }
                  else{
                      iconSize = new google.maps.Size(50, 50);
                  }

                  currentDeliveryTarget.marker = new google.maps.Marker({
                      position: currentDeliveryTarget.position,
                      map: map,
                      icon: {
                          url: currentDeliveryTarget.icon,
                          scaledSize: iconSize
                      }
                  });

                  currentDeliveryTarget.marker.addListener("click", function(){
                      toggleRestaurantInfoPreview(currentDeliveryTarget.name);
                    //  console.log("you clicked on a marker");
                  });

                  Restaurants.push(currentDeliveryTarget);
                }
              })();
            }
            //console.log(realDeliveryTargets);
        }

        function downloadNodeData(nodes){
            let downloadedLocations = nodes;
            let loci = Object.keys(downloadedLocations);
            let order = loci.length;


            console.log("downloaded Locations");
            //console.log(downloadedLocations);

            // convert the downloadedLocations JavaScript Object into the locations JavaScript Array

            for(var locus = 0; locus < order; locus++){
                (function(){
                    locations.push(downloadedLocations[loci[locus]]);
            //        console.log(downloadedLocations[loci[locus]]);
                })();
            }

            // traverse the locations Array to create the markers for the members in the pARk
            for(var i=0; i<locations.length; i++){
                (function(){
                    let currentLocation = {
                        marker: null,
                        position: locations[i].position,
                        icon: locations[i].icon,
                        name: locations[i].name,
                        rating: locations[i].rating,
                        description: locations[i].description,
                        tables: locations[i].tables,
                        zoom: locations[i].zoom,
                        pointer: locations[i].pointer,
                        queueLoc: i,
                        lastPublicPostPreviewAvailable: locations[i].lastPublicPostPreviewAvailable,
                        lastPublicPostPreviewImage: "url(../media/img/yktv-static.gif)",
                        iconSize: locations[i].iconSize,
                        widgetOptions: locations[i].widgetOptions,
                        targets: locations[i].targets
                    };

                    storage.refFromURL(locations[i].lastPublicPostPreviewImage).getDownloadURL().then(function(url){
                        currentLocation.lastPublicPostPreviewImage = `url(${url})`;
                        //console.log(currentLocation);
                    }).catch((error) => {
                        console.log(error);
                    });

                    let iconSize;

                    if(currentLocation.zoom){
                        iconSize = new google.maps.Size(currentLocation.iconSize.x, currentLocation.iconSize.y);
                    }
                    else{
                        iconSize = new google.maps.Size(50, 50);
                    }

                    currentLocation.marker = new google.maps.Marker({
                        position: currentLocation.position,
                        map: map,
                        icon: {
                            url: currentLocation.icon,
                            scaledSize: iconSize
                        }
                    });

                    currentLocation.marker.addListener("click", function(){
                        toggleRestaurantInfoPreview(currentLocation.name);
                      //  console.log("you clicked on a marker");
                    });

                    //console.log(currentLocation);
                    Restaurants.push(currentLocation);
                })();
            }
        }

        function loadMarkers(){
            storage = firebase.storage();
            database = firebase.database();

            const dbRefObject = database.ref().child("members");

            dbRefObject.once("value").then(function(snap){
                //console.log(snap.val());
                downloadNodeData(snap.val());
            });

            loadDroneMarkers();
        }

        function loadDroneMarkers(){
          const deliverRefObject = database.ref().child("orders");

          deliverRefObject.once("value").then(function(snap){
            downloadDailyDeliveryTargets(snap.val());
          });
        }

        firebase.initializeApp(config);

        firebase.auth().signInWithEmailAndPassword("traderjoesdeliverydc@gmail.com", "L3R0!duL0@ng0")
          .then((userCredential) => {
            // Signed in
            console.log("signed in");
            var user = userCredential.user;
            //console.log(user);
            // ...
          })
          .catch((error) => {
            var errorCode = error.code;
            var errorMessage = error.message;
          });

        window.addEventListener("load", function(){
          console.log("content loaded");
          //console.log(navigator.geolocation);
          /*if ("geolocation" in navigator) {
            navigator.geolocation.getCurrentPosition(function(position){
              //alert(position.coords.latitude+" "+position.coords.longitude);
              document.getElementById("latitude-container").innerText = position.coords.latitude;
              document.getElementById("longitude-container").innerText = position.coords.longitude;
            });
          }
          else {
            alert("Geolocation is not supported by this browser.");
          }*/
        });

        document.addEventListener("DOMContentLoaded", function(){
            console.log("attaching button handlers");
            //attachButtonHandlers();
            setTimeout(function(){
                initMap()
            }, 9500);
        });

    </script>
</body>
</html>
